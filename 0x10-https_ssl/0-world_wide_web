#!/usr/bin/env bash
# script to report information about server domains
# shellcheck disable=SC2086

# Function to display subdomain information
display_subdomain_info() {
    local subdomain="$1"
    local domain="$2"
    local record_type="$3"
    local destination="$4"
    echo "The subdomain $subdomain is a $record_type record and points to $destination"
}

# Function to audit subdomains
audit_subdomains() {
    local domain="$1"
    local subdomain="$2"

    # Define the list of subdomains to check
    subdomains="www lb-01 web-01 web-02"

    # Loop through the subdomains
    for sub in $subdomains; do
        if [ -z "$subdomain" ] || [ "$subdomain" == "$sub" ]; then
            # Use awk to extract DNS information from a file
            awk -v sub="$sub" '$1 == sub { print $2, $3 }' "$domain_dns_file" | while read record_type destination; do
                display_subdomain_info "$sub" "$domain" "$record_type" "$destination"
            done
        fi
    done
}

# Main script logic
if [ $# -lt 2 ]; then
    echo "Usage: $0 <domain> <dns_file> [subdomain]"
    exit 1
fi

domain="$1"
domain_dns_file="$2"
subdomain="$3"

audit_subdomains "$domain" "$subdomain"
