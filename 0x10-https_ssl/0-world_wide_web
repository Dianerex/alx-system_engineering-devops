#!/usr/bin/env bash
# script to report information about server domains

display_subdomain_info() {
    local subdomain="$1"
    local domain="$2"
    local record_type="$3"
    local destination="$4"
    echo "The subdomain $subdomain is a $record_type record and points to $destination"
}

# Function to audit subdomains
audit_subdomains() {
    local domain="$1"
    local subdomain="$2"

    # Define the list of subdomains to check
    subdomains="www lb-01 web-01 web-02"

    # Loop through the subdomains
    for sub in $subdomains; do
        if [ -z "$subdomain" ] || [ "$subdomain" == "$sub" ]; then
            # Use dig to fetch DNS information and awk to extract relevant data
            dig_output=$(dig +short "$sub.$domain" | tail -n1)
            if [ -n "$dig_output" ]; then
                display_subdomain_info "$sub" "$domain" "A" "$dig_output"
            fi
        fi
    done
}

# Main script logic
if [ $# -lt 1 ]; then
    echo "Usage: $0 <domain> [subdomain]"
    exit 1
fi

domain="$1"
subdomain="$2"

audit_subdomains "$domain" "$subdomain"
